{
  "prompt": "I want to build a Python MCP server using FastMCP that integrates with our company's REST API. What's the recommended project structure and setup?",
  "baseline_response": "Here's a recommended project structure and setup for building a Python MCP server using FastMCP and integrating with a REST API:\n\nProject Structure:\n```\nmcp-server/\nâ”‚\nâ”œâ”€â”€ src/\nâ”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”œâ”€â”€ main.py\nâ”‚   â”œâ”€â”€ config.py\nâ”‚   â”œâ”€â”€ api_client.py\nâ”‚   â”œâ”€â”€ mcp_handlers/\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”œâ”€â”€ authentication.py\nâ”‚   â”‚   â”œâ”€â”€ game_handlers.py\nâ”‚   â”‚   â””â”€â”€ other_handlers.py\nâ”‚   â”‚\nâ”‚   â””â”€â”€ utils/\nâ”‚       â”œâ”€â”€ __init__.py\nâ”‚       â”œâ”€â”€ logging.py\nâ”‚       â””â”€â”€ error_handling.py\nâ”‚\nâ”œâ”€â”€ tests/\nâ”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”œâ”€â”€ test_mcp_handlers.py\nâ”‚   â””â”€â”€ test_api_client.py\nâ”‚\nâ”œâ”€â”€ requirements.txt\nâ”œâ”€â”€ README.md\nâ””â”€â”€ .env\n```\n\nHere's a sample implementation:\n\n1. `requirements.txt`:\n```\nfastmcp\naiohttp\npython-dotenv\npydantic\n```\n\n2. `src/config.py`:\n```python\nfrom pydantic import BaseSettings\n\nclass Settings(BaseSettings):\n    API_BASE_URL: str\n    API_TOKEN: str\n    MCP_HOST: str = '0.0.0.0'\n    MCP_PORT: int = 10623\n\n    class Config:\n        env_file = '.env'\n\nsettings = Settings()\n```\n\n3. `src/api_client.py`:\n```python\nimport aiohttp\nfrom typing import Dict, Any\n\nclass APIClient:\n    def __init__(self, base_url: str, token: str):\n        self._base_url = base_url\n        self._headers = {\n            'Authorization': f'Bearer {token}',\n            'Content-Type': 'application/json'\n        }\n\n    async def make_request(self, endpoint: str, method: str = 'GET', data: Dict[str, Any] = None):\n        async with aiohttp.ClientSession() as session:\n            async with session.request(\n                method, \n                f\"{self._base_url}/{endpoint}\", \n                headers=self._headers, \n                json=data\n            ) as response:\n                response.raise_for_status()\n                return await response.json()\n```\n\n4. `src/mcp_handlers/authentication.py`:\n```python\nfrom fastmcp import MCPHandler\nfrom src.api_client import APIClient\nfrom src.config import settings\n\nclass AuthenticationHandler(MCPHandler):\n    def __init__(self, api_client: APIClient):\n        self.api_client = api_client\n\n    async def handle_login(self, request):\n        try:\n            # Validate login credentials via REST API\n            login_data = {\n                'username': request.get('username'),\n                'password': request.get('password')\n            }\n            \n            # Call authentication endpoint\n            response = await self.api_client.make_request(\n                'auth/login', \n                method='POST', \n                data=login_data\n            )\n\n            # Return authentication result\n            return {\n                'status': 'success',\n                'token': response.get('token')\n            }\n        except Exception as e:\n            return {\n                'status': 'error',\n                'message': str(e)\n            }\n```\n\n5. `src/main.py`:\n```python\nimport asyncio\nfrom fastmcp import FastMCP\nfrom src.config import settings\nfrom src.api_client import APIClient\nfrom src.mcp_handlers.authentication import AuthenticationHandler\n\nasync def main():\n    # Initialize API client\n    api_client = APIClient(\n        base_url=settings.API_BASE_URL, \n        token=settings.API_TOKEN\n    )\n\n    # Create FastMCP server\n    mcp_server = FastMCP()\n\n    # Register handlers\n    mcp_server.add_handler('login', AuthenticationHandler(api_client).handle_login)\n\n    # Start server\n    await mcp_server.start(\n        host=settings.MCP_HOST, \n        port=settings.MCP_PORT\n    )\n\nif __name__ == '__main__':\n    asyncio.run(main())\n```\n\n6. `.env` file:\n```\nAPI_BASE_URL=https://your-company-api.com/v1\nAPI_TOKEN=your_api_token\nMCP_HOST=0.0.0.0\nMCP_PORT=10623\n```\n\n7. `tests/test_api_client.py`:\n```python\nimport pytest\nfrom src.api_client import APIClient\n\n@pytest.mark.asyncio\nasync def test_api_client():\n    client = APIClient('https://test-api.com', 'test-token')\n    \n    # Mock the request\n    with pytest.mock.patch('aiohttp.ClientSession.request') as mock_request:\n        mock_response = pytest.mock.AsyncMock()\n        mock_response.json.return_value = {'status': 'success'}\n        mock_request.return_value.__aenter__.return_value = mock_response\n        \n        result = await client.make_request('test/endpoint')\n        assert result == {'status': 'success'}\n```\n\nKey Considerations:\n- Use environment variables for configuration\n- Implement async API client for non-blocking requests\n- Create modular handler classes\n- Add comprehensive error handling\n- Use type hints and pydantic for configuration\n- Write unit tests for critical components\n\nRecommended Enhancements:\n- Add logging\n- Implement more robust error handling\n- Create middleware for authentication and request validation\n- Add rate limiting and security measures\n\nDependencies:\n```bash\n# Install dependencies\npip install -r requirements.txt\n\n# Run the server\npython -m src.main\n```\n\nThis structure provides a scalable, maintainable approach to building an MCP server with REST API integration, following best practices for Python async programming and server development.",
  "skill_response": "I'll provide a comprehensive guide for setting up a Python MCP server with FastMCP, including project structure, dependencies, and initial implementation steps.\n\n### ğŸ—ï¸ Recommended Project Structure\n\n```\nmy-company-mcp-server/\nâ”‚\nâ”œâ”€â”€ src/\nâ”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”œâ”€â”€ server.py           # Main MCP server configuration\nâ”‚   â”œâ”€â”€ tools/              # Individual tool implementations\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”œâ”€â”€ user_management.py\nâ”‚   â”‚   â”œâ”€â”€ resource_tools.py\nâ”‚   â”‚   â””â”€â”€ reporting_tools.py\nâ”‚   â”‚\nâ”‚   â”œâ”€â”€ clients/            # API client implementations\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â””â”€â”€ company_api_client.py\nâ”‚   â”‚\nâ”‚   â””â”€â”€ utils/              # Shared utilities\nâ”‚       â”œâ”€â”€ __init__.py\nâ”‚       â”œâ”€â”€ auth.py\nâ”‚       â””â”€â”€ error_handling.py\nâ”‚\nâ”œâ”€â”€ tests/                  # Test suite\nâ”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”œâ”€â”€ test_tools.py\nâ”‚   â””â”€â”€ test_integration.py\nâ”‚\nâ”œâ”€â”€ pyproject.toml          # Modern Python dependency management\nâ”œâ”€â”€ requirements.txt        # Backup requirements file\nâ”œâ”€â”€ README.md\nâ””â”€â”€ .env                    # Environment configuration\n```\n\n### ğŸ“¦ Dependencies Setup\n\nCreate a `pyproject.toml` for dependency management:\n\n```toml\n[build-system]\nrequires = [\"hatchling\"]\nbuild-backend = \"hatchling.build\"\n\n[project]\nname = \"company-mcp-server\"\nversion = \"0.1.0\"\ndependencies = [\n    \"fastmcp>=0.5.0\",\n    \"pydantic>=2.0.0\",\n    \"httpx>=0.24.0\",\n    \"python-dotenv>=1.0.0\"\n]\n\n[project.optional-dependencies]\ndev = [\n    \"pytest>=7.3.1\",\n    \"mypy>=1.3.0\",\n    \"ruff>=0.0.272\"\n]\n```\n\n### ğŸ”’ Environment Configuration\n\nCreate a `.env` file:\n```\nCOMPANY_API_BASE_URL=https://api.yourcompany.com/v1\nCOMPANY_API_KEY=your_secret_api_key\nMCP_SERVER_PORT=8000\n```\n\n### ğŸš€ Basic Server Implementation\n\n`src/server.py`:\n```python\nfrom fastmcp import FastMCPServer\nfrom dotenv import load_dotenv\nimport os\n\n# Load environment variables\nload_dotenv()\n\n# Import your tools\nfrom .tools.user_management import user_tools\nfrom .tools.resource_tools import resource_tools\n\nclass CompanyMCPServer(FastMCPServer):\n    def __init__(self):\n        super().__init__()\n        \n        # Register tool collections\n        self.register_tools(user_tools)\n        self.register_tools(resource_tools)\n\n    def configure_server(self):\n        # Additional server configuration\n        self.port = int(os.getenv('MCP_SERVER_PORT', 8000))\n\ndef create_server():\n    return CompanyMCPServer()\n\n# Example tool implementation in src/tools/user_management.py\nfrom fastmcp import tool\nfrom pydantic import BaseModel, Field\n\nclass UserSearchParams(BaseModel):\n    query: str = Field(..., description=\"Search query for users\")\n    limit: int = Field(10, description=\"Maximum number of results\")\n\n@tool\ndef search_users(params: UserSearchParams):\n    \"\"\"\n    Search for users in the company system.\n    \n    Hints:\n    - readOnlyHint: true\n    - openWorldHint: true\n    \"\"\"\n    # Implement user search logic using company API client\n    pass\n\nuser_tools = [search_users]\n```\n\n### ğŸ›¡ï¸ API Client Example\n\n`src/clients/company_api_client.py`:\n```python\nimport httpx\nfrom typing import Dict, Any\nfrom dotenv import load_dotenv\nimport os\n\nload_dotenv()\n\nclass CompanyAPIClient:\n    def __init__(self):\n        self.base_url = os.getenv('COMPANY_API_BASE_URL')\n        self.api_key = os.getenv('COMPANY_API_KEY')\n        \n        self.client = httpx.Client(\n            base_url=self.base_url,\n            headers={\n                'Authorization': f'Bearer {self.api_key}',\n                'Content-Type': 'application/json'\n            }\n        )\n    \n    def search_users(self, query: str, limit: int = 10) -> Dict[str, Any]:\n        response = self.client.get(\n            '/users/search', \n            params={'q': query, 'limit': limit}\n        )\n        response.raise_for_status()\n        return response.json()\n```\n\n### ğŸ§ª Testing Setup\n\n`tests/test_tools.py`:\n```python\nimport pytest\nfrom src.server import create_server\n\ndef test_user_search():\n    server = create_server()\n    \n    # Test user search tool\n    result = server.call_tool('search_users', {\n        'query': 'test',\n        'limit': 5\n    })\n    \n    assert 'users' in result\n    assert len(result['users']) <= 5\n```\n\n### ğŸš¢ Running the Server\n\nAdd a `run.py` in the project root:\n```python\nfrom src.server import create_server\n\ndef main():\n    server = create_server()\n    server.run()\n\nif __name__ == '__main__':\n    main()\n```\n\n### ğŸ“‹ Recommended Development Workflow\n\n1. Install dependencies:\n```bash\npip install -e .[dev]\n```\n\n2. Run linting:\n```bash\nruff check src\nmypy src\n```\n\n3. Run tests:\n```bash\npytest tests/\n```\n\n4. Start the server:\n```bash\npython run.py\n```\n\n### ğŸŒŸ Key Recommendations\n\n1. Use Pydantic for input validation\n2. Implement comprehensive error handling\n3. Add descriptive tool hints\n4. Use environment variables for configuration\n5. Create modular, testable tools\n6. Implement comprehensive logging\n\n### ğŸ” Next Steps\n\n1. Expand tool implementations\n2. Add more comprehensive error handling\n3. Implement authentication middleware\n4. Create more complex tool interactions\n5. Build comprehensive test coverage\n\nWould you like me to elaborate on any specific aspect of the MCP server implementation?",
  "verdict": "skill",
  "reasoning": "Response A is significantly better across all evaluation criteria. It provides a more comprehensive and accurate guide for building a Python MCP server with FastMCP. Key advantages: 1) Better project structure with logical separation of concerns (tools/, clients/, utils/), 2) Uses modern Python practices (pyproject.toml, proper dependency management), 3) More accurate FastMCP implementation with proper tool decoration and registration patterns, 4) Includes proper Pydantic models for input validation, 5) More complete testing setup, 6) Better development workflow recommendations, 7) More detailed and actionable code examples. Response B has several issues including potentially incorrect FastMCP API usage (MCPHandler class that may not exist), less modern Python practices, and a more basic overall structure. Response A demonstrates deeper understanding of both FastMCP and modern Python development practices.",
  "baseline_tokens": 1501,
  "skill_tokens": 3878,
  "position_a": "skill",
  "position_b": "baseline",
  "judge_model": "claude-sonnet-4-20250514",
  "judged_at": "2026-01-11T18:18:11.635387Z"
}